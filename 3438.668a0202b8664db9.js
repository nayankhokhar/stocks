"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3438],{3438:(N,h,p)=>{p.r(h),p.d(h,{PortfolioPageModule:()=>j});var P=p(2881),I=p(9417),y=p(3092),F=p(5207),e=p(1360),q=p(2557);function E(t,r){if(1&t&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td",4),e.EFF(4),e.k0s(),e.j41(5,"td",4),e.EFF(6),e.k0s(),e.j41(7,"td",4),e.EFF(8),e.k0s(),e.j41(9,"td",4),e.EFF(10),e.k0s(),e.j41(11,"td"),e.EFF(12),e.k0s()()),2&t){const i=r.$implicit;e.R7$(2),e.JRh(i.name),e.R7$(2),e.JRh(i.totalQty),e.R7$(2),e.JRh(i.avgPrice),e.R7$(2),e.JRh(i.totalInvestment),e.R7$(2),e.Lme("",i.totalDividend," - ",i.totalDividendPercentage,""),e.R7$(2),e.LHq("",i.upcoming_dividend_date," : ",i.upcoming_dividend_percentage,"% : ",i.upcoming_dividend_price_per_share," : ",i.upcoming_dividend_total_dividends,"")}}const A=[{path:"",component:(()=>{var t;class r{constructor(n){this.http=n,this.portfolio=[{name:"The Tata Power Company Ltd.",holding:[{qty:5,date:"26-03-2025",price:378.9}],fundamentalAPI:"TPC"},{name:"Ircon International Ltd.",holding:[{qty:19,date:"25-07-2024",price:288.6},{qty:6,date:"06-08-2024",price:273.5},{qty:3,date:"19-08-2024",price:270.65},{qty:19,date:"20-08-2024",price:266.65},{qty:9,date:"18-09-2024",price:234.35},{qty:21,date:"19-09-2024",price:220.2},{qty:22,date:"07-10-2024",price:208.99},{qty:30,date:"14-01-2025",price:186.85}],fundamentalAPI:"II21"},{name:"GM Breweries Ltd.",holding:[{qty:2,date:"15-04-2025",price:1301.8}],fundamentalAPI:"GMB"},{name:"Indian Oil Corporation Ltd.",holding:[{qty:14,date:"23-05-2025",price:145.15}],fundamentalAPI:"IOC"},{name:"NHPC Ltd.",holding:[{qty:23,date:"22-05-2025",price:88.24}],fundamentalAPI:"N07"},{name:"Power Finance Corporation Ltd.",holding:[{qty:5,date:"21-05-2025",price:406.45}],fundamentalAPI:"N07"},{name:"Anant Raj Ltd.",holding:[{qty:2,date:"28-04-2025",price:460.1},{qty:2,date:"22-04-2025",price:513.5}],fundamentalAPI:"ARI"},{name:"DLF",holding:[{qty:3,date:"21-05-2025",price:772}],fundamentalAPI:"D04"},{name:"Hindustan Zinc",holding:[{qty:4,date:"27-06-2025",price:453.45}],fundamentalAPI:"HZ"},{name:"Bombay Burmah Trdg.",holding:[{qty:1,date:"10-06-2025",price:2015}],fundamentalAPI:"BBT"},{name:"Tata Motors",holding:[{qty:11,date:"03-10-2024",price:933.35},{qty:1,date:"29-10-2024",price:841},{qty:1,date:"25-02-2025",price:671.3},{qty:5,date:"27-03-2025",price:673.2}],fundamentalAPI:"TEL"}]}ngOnInit(){this.processHoldings()}processHoldings(){const n=this.portfolio.map(d=>this.extractDividendsData(d.fundamentalAPI));Promise.all(n).then(()=>{this.portfolio.forEach(d=>{let u=0,l=0,s=0;d.holding.forEach(a=>{var c;u+=a.qty,l+=a.qty*a.price,null==a||null===(c=a.dividends)||void 0===c||c.forEach(o=>{s+=Number(o.totalDividends)})}),d.totalQty=u,d.totalInvestment=Number(l).toFixed(2),d.avgPrice=Number(u>0?l/u:0).toFixed(2),d.totalDividend=Number(s).toFixed(2),d.totalDividendPercentage=l>0?(s/l*100).toFixed(2):"0.00"})}),console.log(this.portfolio)}extractDividendsData(n){const d=`https://api.moneycontrol.com/mcapi/v1/stock/corporate-action?deviceType=W&scId=${n}&section=d&start=0&limit=20`;return new Promise((u,l)=>{this.http.get(d).subscribe({next:s=>{this.portfolio.forEach(a=>{if(a.fundamentalAPI===n){let c=[];if(a.holding.forEach(o=>{const g=new Date(this.parseDate(o.date));o.dividends=[],s.data.dividends.forEach(f=>{const m=new Date(this.parseDate(f.effective_date)),v=Number(f.dividend_amount),D=Number((v/o.price*100).toFixed(2)),_=Number(o.qty*v).toFixed(2);m<new Date&&m>g&&o.dividends.push({effective_date:f.effective_date,dividend_per_share_percentage:D,dividend_amount:v,totalDividends:_,is_upcoming:!1}),m>new Date&&c.push({effective_date:f.effective_date,dividend_per_share_percentage:D,dividend_amount:v,totalDividends:_,effectiveDate:m,price_per_share:o.price})})}),c.length>0){c.sort((g,f)=>g.effectiveDate-f.effectiveDate);const o=c[0];a.upcoming_dividend_date=o.effective_date,a.upcoming_dividend_percentage=o.dividend_per_share_percentage,a.upcoming_dividend_price_per_share=o.dividend_amount,a.upcoming_dividend_total_dividends=o.totalDividends}}}),u()},error:s=>l(s)})})}parseDate(n){if(n.includes("-")){const[a,c,o]=n.split("-").map(Number);return new Date(o,c-1,a)}const[d,u,l]=n.split(" "),s=new Date(`${u} 1, 2000`).getMonth();return new Date(Number(l),s,Number(d.replace(",","")))}}return(t=r).\u0275fac=function(n){return new(n||t)(e.rXU(q.Qq))},t.\u0275cmp=e.VBU({type:t,selectors:[["app-portfolio"]],standalone:!1,decls:19,vars:2,consts:[["color","dark",3,"fullscreen"],[1,"m-3"],[1,"table","table-dark","table-bordered"],[4,"ngFor","ngForOf"],[1,"text-end"]],template:function(n,d){1&n&&(e.j41(0,"ion-content",0)(1,"div",1)(2,"table",2)(3,"thead")(4,"tr")(5,"th"),e.EFF(6,"Name"),e.k0s(),e.j41(7,"th"),e.EFF(8,"Total Qty"),e.k0s(),e.j41(9,"th"),e.EFF(10,"Avg Price"),e.k0s(),e.j41(11,"th"),e.EFF(12,"Total Invested Amount"),e.k0s(),e.j41(13,"th"),e.EFF(14,"Total Dividend Received"),e.k0s(),e.j41(15,"th"),e.EFF(16,"Upcoming Dividends"),e.k0s()()(),e.j41(17,"tbody"),e.DNE(18,E,13,10,"tr",3),e.k0s()()()()),2&n&&(e.Y8G("fullscreen",!0),e.R7$(18),e.Y8G("ngForOf",d.portfolio))},dependencies:[P.Sq,y.W9],encapsulation:2}),r})()}];let R=(()=>{var t;class r{}return(t=r).\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[F.iI.forChild(A),F.iI]}),r})(),j=(()=>{var t;class r{}return(t=r).\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[P.MD,I.YN,y.bv,R]}),r})()}}]);